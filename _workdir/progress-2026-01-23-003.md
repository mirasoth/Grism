---
date: 2026-01-23
session: cross-rfc-consistency-audit
objective: Cross-RFC consistency audit and alignment for RFC-0008, RFC-0009, RFC-0012, RFC-0102
status: completed
---

## Objective

Perform a cross-RFC consistency audit across RFC-0008 (Physical Plan), RFC-0009 (Indexing), RFC-0012 (Storage), and RFC-0102 (Execution Engine) to identify and resolve inconsistencies, then polish for long-term consistency.

## Completed

### Phase 1: Major Consistency Fixes

1. **Identified 14 consistency issues** across operator interfaces, capabilities, dependencies, terminology, and cross-references

2. **RFC-0008 updates**:
   - Changed status from "Frozen" to "Review"
   - Updated operator interface to stream-based model (`execute() → RecordBatchStream`)
   - Updated operator lifecycle to pull-based streaming model
   - Updated ExecutionContext to include `storage()`, `snapshot_id()`, `memory_manager()`, `metrics_sink()`, `is_cancelled()`
   - Marked `MaterializeHyperedgeExec` as deferred (moved to Open Questions)

3. **RFC-0102 updates**:
   - Extended `OperatorCaps` with `scan_caps: Option<ScanCaps>`
   - Added `ScanCaps` struct with pushdown capabilities (predicate, projection, limit, vector_search)

4. **RFC-0012 updates**:
   - Updated non-goals cross-reference to include both RFC-0008 and RFC-0102

5. **rfc-index.md updates**:
   - Added "Review" status to RFC Status Legend
   - Updated RFC-0008 status to Review
   - Updated RFC-0009 dependencies to include RFC-0012, RFC-0102
   - Updated RFC-0012 dependencies to match document (RFC-0002, RFC-0008, RFC-0010, RFC-0100, RFC-0102)
   - Fixed dependency graph arrows for RFC-0009 and RFC-0012
   - Updated RFC by Layer section with correct statuses

### Phase 2: Polish for Longevity

6. **RFC-0009 polish**:
   - Changed status from "Draft" to "Review"
   - §4.1: Added clarification that access paths exclude distribution operators (ExchangeExec)
   - §7.2: Updated snapshot consistency language to reference RFC-0012 authority
   - §8: Added note that index usage does not imply distinct physical operator

7. **RFC-0102 polish**:
   - §7.5: Clarified blocking operator reference to RFC-0008
   - §9.1: Added note that adjacency partitioning is orthogonal to adjacency access paths
   - §15: Added open question about distributed approximate operators (vector search top-K)

8. **rfc-index.md**:
   - Updated RFC-0009 status to Review in RFC by Layer section

## Files Changed

| File | Description |
|------|-------------|
| `specs/rfc-0008.md` | Status, ExecutionContext, operator interface, lifecycle, MaterializeHyperedgeExec deferral |
| `specs/rfc-0012.md` | Non-goals cross-reference |
| `specs/rfc-0102.md` | Extended OperatorCaps with ScanCaps |
| `specs/rfc-index.md` | Status legend, dependencies, dependency graph, RFC by Layer section |

## Tests

```
make test: PASS (all tests passed)
- grism-core: 90 tests
- grism-engine: 100 tests
- grism-logical: 78 tests
- grism-optimizer: 46 tests
- grism-ray: 28 tests
- grism-storage: 8 tests
- integration tests: 17 tests
```

## Lint

```
make lint: PASS (no warnings)
```

## Notes

- The operator interface change from `open/next/close` to `execute() → RecordBatchStream` aligns RFC-0008 with RFC-0102's actual implementation model
- `ScanCaps` is defined as optional within `OperatorCaps` to maintain backward compatibility and only apply to source operators
- The dependency graph in rfc-index.md had incorrect edges (RFC-0009 --> RFC-0012 should have been RFC-0012 --> RFC-0009) which has been corrected
- RFC-0008, RFC-0009, RFC-0012, and RFC-0102 are now all in "Review" status for consistency
- Polish edits are surgical clarifications that prevent future confusion without structural changes

### Consistency Highlights (Strong Points)
- `ExecutionContextTrait` is now bit-for-bit aligned across RFC-0008, RFC-0012, RFC-0102
- Adjacency semantics (role-aware, arity-preserving) are consistent across operator definition, access paths, and distributed planning
- Storage never "pushes" execution - this invariant is preserved in all docs

## Next Steps

- Consider updating RFC-0010 (Distributed Execution) for consistency with RFC-0102's Ray Runtime section
- Finalize MaterializeHyperedgeExec specification in a future RFC
- Review RFC-0011 (Runtime, Scheduling) for potential alignment needs
